
# Cross-Site Scripting (XSS) Pen-Testing Guide

## Table of Contents

1. [Introduction](#introduction)
2. [Identification Methods](#identification-methods)
    - [Stored XSS](#stored-xss)
    - [Reflected XSS](#reflected-xss)
    - [DOM-Based XSS](#dom-based-xss)
3. [Mitigation](#mitigation)
4. [References](#references)

---

## INTRODUCTION
Cross-Site Scripting (XSS) is a vulnerability that allows attackers to inject malicious scripts into web pages viewed by other users. These scripts can execute within the context of the victim’s browser, leading to potential data theft, session hijacking, and other malicious activities. This guide covers methods for identifying XSS vulnerabilities.

## Identification Methods

### 1. [Stored XSS](#stored-xss)
**Stored XSS** occurs when user input containing malicious scripts is stored on the server (e.g., in a database) and later served to users. To perform Stored XSS testing, inject payloads into input fields or storage mechanisms and observe if the script executes when the data is retrieved. Here are some **Example Payloads**:
```html
<script>alert('Stored XSS');</script>
<img src="x" onerror="alert('Stored XSS')">
```

**Detection**: Inject payloads into user-generated content areas (e.g., comment sections, forums) and check if they execute when viewed by other users. Use tools like Burp Suite or OWASP ZAP to automate payload injection and verification.

---
### 2. [Reflected XSS](#reflected-xss)
**Reflected XSS** happens when an attacker’s script is reflected off the server in immediate responses, such as through URL parameters or form submissions. To perform Reflected XSS testing, modify URL parameters or form inputs to include malicious scripts and check if they execute in the response. Here are some **Example Payloads**:
```html
<script>alert('Reflected XSS');</script>
```
```html
<img src="x" onerror="alert('Reflected XSS')">
```
**Detection**: Inject payloads into URL parameters or form inputs and monitor the response for script execution. Test if the application reflects user inputs without proper encoding or sanitization.

---
### 3. [DOM-Based XSS](#dom-based-xss)
**DOM-Based XSS** involves client-side scripts manipulating the DOM to execute injected scripts. Unlike Stored or Reflected XSS, the payload is executed without server-side involvement. To perform DOM-Based XSS testing, inject payloads into URL fragments or form fields and observe if client-side JavaScript executes the script. Here are some **Example Payloads**:
```html
<script>
  document.location.hash="<script>alert('DOM XSS')</script>";
</script>
```
```html
<div id="target"></div>
<script>
  document.getElementById('target').innerHTML = "<img src=x onerror=alert('DOM XSS')>";
</script>
```

**Detection**: Modify URL fragments or input fields to include payloads and observe changes in the DOM. Use browser developer tools to inspect the client-side scripts and verify how they handle user inputs.

## Mitigation

1. **Input Validation**: Ensure rigorous validation and sanitization of user inputs on both client and server sides.
2. **Output Encoding**: Encode data before rendering it on web pages. Use context-specific encoding (e.g., HTML entity encoding, JavaScript escaping).
3. **Content Security Policy (CSP)**: Implement CSP to restrict the sources from which scripts can be loaded, mitigating the risk of XSS attacks.
4. **Use Secure Frameworks**: Leverage modern frameworks and libraries with built-in XSS protection mechanisms, such as Angular or React.
5. **Regular Security Audits**: Conduct periodic security assessments and code reviews to identify and fix XSS vulnerabilities.

## References

- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_(XSS)_Prevention_Cheat_Sheet.html)
- [OWASP XSS Top 10](https://owasp.org/www-community/attacks/xss/)
- [Burp Suite Documentation](https://portswigger.net/burp/documentation)
- [W3Schools XSS Tutorial](https://www.w3schools.com/asp/asp_xss.asp)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
